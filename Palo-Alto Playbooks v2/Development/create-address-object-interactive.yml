---
- name: Gather Object Facts
  hosts: firewall
  connection: local
  ignore_errors: true
  #gather_facts: yes

  vars:
    device:
      ip_address: "{{ ip_address }}"
      username: "{{ username }}"
      password: "{{ password }}"

  vars_prompt:
    - name: source_ip_new_name
      prompt: New Device - Please create a new object - Enter in object name 'server-001_ip-address'
      private: false

    - name: source_ip_new_type
      prompt: Enter type of Object ip-netmask(default), ip-range, fqdn
      default: ip-netmask

    - name: source_ip_new_value
      prompt: Enter the IP address of the object e.g 10.10.10.10/32 or 10.10.10.0/28 if ip-range
      private: false

    - name: source_ip_new_description
      prompt: Enter a description of this object
      private: false

    - name: source_ip
      prompt: Enter in Source IP Address server-001_ip-address e.g server-001_1.1.1.1/32
      private: false
      default: "{{ source_ip_new_name }}"

    - name: destination_zone
      prompt: Enter the Destiation Security Zone
      private: false

    - name: destination_ip_new_name
      prompt: New Device - Please create a new object - Enter in object name 'server-001_ip-address'
      private: false

    - name: destination_ip_new_type
      prompt: Enter type of Object ip-netmask(default), ip-range, fqdn
      default: ip-netmask

    - name: destination_ip_new_value
      prompt: Enter the IP address of the object e.g 10.10.10.10/32 or 10.10.10.0/28 if ip-range
      private: false

    - name: destination_ip_new_description
      prompt: Enter a description of this object
      private: false

    - name: destination_ip
      prompt: Enter in Destiation IP Address server-001_ip-address e.g server-001_1.1.1.1/32
      private: false
      default: "{{ destination_ip_new_name }}"

  collections:
    - paloaltonetworks.panos

  tasks:
    - name: Create Address Object New Source
      paloaltonetworks.panos.panos_address_object:
        provider: "{{ device }}"
        name: "{{ source_ip_new_name | default(omit) }}"
        address_type: "{{ source_ip_new_type | default(omit) }}"
        value: "{{ source_ip_new_value | default(omit) }}"
        description: "{{ source_ip_new_description | default(omit) }}"

    - name: Create Address Object New Destination
      paloaltonetworks.panos.panos_address_object:
        provider: "{{ device }}"
        name: "{{ destination_ip_new_name | default(omit) }}"
        address_type: "{{ destination_ip_new_type | default(omit) }}"
        value: "{{ destination_ip_new_value | default(omit) }}"
        description: "{{ destination_ip_new_description | default(omit) }}"

    - name: Commit candidate configuration
      paloaltonetworks.panos.panos_commit_firewall:
        provider: "{{ device }}"
      register: results
    - debug:
        msg: "Commit with Job ID: {{ results.jobid }} had output: {{ results.details }}"
